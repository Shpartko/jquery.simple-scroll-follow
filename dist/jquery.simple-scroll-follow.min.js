/**
 * @file jquery.simple-scroll-follow
 * @version 3.0.0
 * @author Yuusaku Miyazaki <toumin.m7@gmail.com>
 * @license MIT
 */
!function(a){a.fn.simpleScrollFollow=function(b){var c=Array.prototype.slice.call(arguments,1);return this.each(function(){a.fn.simpleScrollFollow.processEach(this,b,c)})},a.fn.simpleScrollFollow.processEach=function(b,c,d){var e=a(b).data("simple-scroll-follow");return e&&c in e&&"_"!=c.charAt(0)?(e[c].apply(e,d),"call public method"):"object"!=typeof c&&c?(console.error('Sub-method "'+c+'" does not exist on $.simpleScrollFollow'),"error"):(a(b).data("simple-scroll-follow",new a.simpleScrollFollow(b,c)),"init plugin")},a.simpleScrollFollow=function(b,c){this._setOption(c),this._setFollow(b);var d=this;a(window).scroll(function(){d._handleScroll.call(d)}),this.timer=!1,a(window).resize(function(){d._handleResize.call(d)})},a.extend(a.simpleScrollFollow.prototype,{setEnabled:function(a){return void 0===a||a?this.option.enabled=!0:(this._moveDefaultPosition(),this.option.enabled=!1)},_moveDefaultPosition:function(){a(this.follow.elem).css({position:"",top:"",bottom:"",left:"",right:""}).width("")},_setFollow:function(b){return this.follow={elem:b,width:a(b).width(),offset_top:a(b).offset().top,offset_bottom:this._calcOffsetBottom(b),offset_left:a(b).offset().left,position_top:"auto"==a(b).css("top")?0:Number(a(b).css("top").replace(/px$/,""))}},_setOption:function(b){return this.option=a.extend({enabled:!0,limit_elem:a("body"),min_width:0},b),"string"==typeof this.option.limit_elem&&(this.option.limit_elem=a(this.option.limit_elem)),this.option},_calcOffsetBottom:function(b){return a(b).offset().top+a(b).height()+Number(a(b).css("border-top-width").replace(/px$/,""))+Number(a(b).css("border-bottom-width").replace(/px$/,""))+Number(a(b).css("padding-top").replace(/px$/,""))+Number(a(b).css("padding-bottom").replace(/px$/,""))},_handleScroll:function(){if(!this.option.enabled)return!1;if(a(window).width()<this.option.min_width)return this._moveDefaultPosition.call(this),!1;var b={scroll_top:a(window).scrollTop(),scroll_bottom:a(window).scrollTop()+a(window).height()},c={offset_top:a(this.follow.elem).offset().top,offset_bottom:this._calcOffsetBottom(this.follow.elem)},d={offset_bottom:this._calcOffsetBottom(this.option.limit_elem)};return!(d.offset_bottom-this.follow.offset_top<c.offset_bottom-c.offset_top)&&(this._handleScrollMain(b,c,d),!0)},_handleScrollMain:function(a,b,c){return a.scroll_top<this.follow.offset_top?(this._move1(),1):a.scroll_top>c.offset_bottom?(this._move2(b,c),2):a.scroll_bottom-a.scroll_top>b.offset_bottom-b.offset_top?c.offset_bottom-a.scroll_top<b.offset_bottom-b.offset_top?(this._move2(b,c),3):(this._move3(),4):a.scroll_bottom>c.offset_bottom?(this._move2(b,c),5):a.scroll_bottom-this.follow.offset_top>b.offset_bottom-b.offset_top?(this._move4(),6):(this._move1(),7)},_move1:function(){a(this.follow.elem).css({position:"absolute",top:"",bottom:"",left:"",right:""}).width(this.follow.width)},_move2:function(b,c){a(this.follow.elem).css({position:"absolute",top:c.offset_bottom-this.follow.offset_top-(b.offset_bottom-b.offset_top)+this.follow.position_top,bottom:"auto",left:"",right:""}).width(this.follow.width)},_move3:function(){a(this.follow.elem).css({position:"fixed",top:0,bottom:"auto",left:this.follow.offset_left,right:"auto"}).width(this.follow.width)},_move4:function(){a(this.follow.elem).css({position:"fixed",top:"auto",bottom:0,left:this.follow.offset_left,right:"auto"}).width(this.follow.width)},_handleResize:function(){!1!==this.timer&&clearTimeout(this.timer);var b=this;return this.timer=setTimeout(function(){b._moveDefaultPosition.call(b),b._setFollow.call(b,b.follow.elem),a(window).trigger("scroll")},200)}})}(jQuery);